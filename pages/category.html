<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Category â€” JobPulse Kolkata</title>
    <link rel="stylesheet" href="/assets/css/style.css">
  </head>
  <body>
    <div class="container">
      <h1 id="catTitle">Category</h1>
      <div id="list" class="grid"></div>
    </div>
    <script type="module">
      import { el, truncate, getQuery } from '/assets/js/utils.js';
      async function getRSS(){ try{ const r=await fetch('/api/rss'); const j=await r.json(); return j.items||[] }catch{ return [] } }
      function card(p){
        const c = el('article','card');
        c.innerHTML = `<h3><a href="/pages/post.html?title=${encodeURIComponent(p.title)}&link=${encodeURIComponent(p.link)}&desc=${encodeURIComponent(p.description)}&date=${encodeURIComponent(p.pubDate||'')}">${p.title}</a></h3><p>${truncate(p.description, 180)}</p>`;
        return c;
      }
      (async()=>{
        const name = getQuery('name') || 'news';
        document.getElementById('catTitle').textContent = name.charAt(0).toUpperCase() + name.slice(1);
        const data = await getRSS();
        const list = document.getElementById('list');
        const items = data.filter(p => (p.category||'news').toLowerCase() === name.toLowerCase());
        items.forEach(p=> list.appendChild(card(p)));
        if(!list.children.length){
          const msg = document.createElement('p'); msg.className='notice'; msg.textContent='No posts in this category yet.';
          list.parentElement.appendChild(msg);
        }
      })();
    </script>
    <script type="module" src="/assets/js/main.js"></script>
  </body>
</html>
